<div class="flex justify-between">
    <h2 mat-dialog-title>Summary</h2>
    <!-- <button mat-button class="matBtn" (click)="copyToClipboard()">COPY</button> -->
</div>

<mat-dialog-content class="mat-typography">
    <div class="mat-elevation-z8">
        <table class="pagi_table" mat-table [dataSource]="dataSource">
            <ng-container matColumnDef="aproved_by">
                <th mat-header-cell *matHeaderCellDef>APPROVED BY</th>
                <td mat-cell *matCellDef="let element">{{ element.approved_by }}</td>
            </ng-container>
            <ng-container matColumnDef="is_approved" >
                <th mat-header-cell *matHeaderCellDef>âœ”</th>
                <td mat-cell *matCellDef="let element">
                    <div *ngIf="!textField">
                    <input
                        type="checkbox"
                        [checked]="element.approved_check"
                        (change)="getEntryData(element, 'approved_check')"
                    />
                </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="over_time"  >
                <th mat-header-cell *matHeaderCellDef>OT</th>
                <td mat-cell *matCellDef="let element">

                    <div *ngIf="!textField">
                    <div *ngIf="this.hasValue(element.ot_number); else ifNoValue">
                        <input
                            type="checkbox"
                            [checked]="element.is_ot"
                            (change)="getEntryData(element, 'is_ot')"
                            [disabled]="element.approved_check"
                        />
                    </div>
                    <ng-template #ifNoValue>
                        <input
                            type="checkbox"
                            [checked]="element.is_ot"
                            (change)="getEntryData(element, 'is_ot')"
                            [disabled]="'true'"
                        />
                    </ng-template>

                </div>
            </td>
        </ng-container>

            <ng-container matColumnDef="night_diff" >
                <th mat-header-cell *matHeaderCellDef>ND</th>
                <td mat-cell *matCellDef="let element">
                    <div *ngIf="!textField">
                    <div *ngIf="this.hasValue(element.nd_number); else ifNoValue">
                        <input
                            type="checkbox"
                            [checked]="element.is_nd"
                            (change)="getEntryData(element, 'is_nd')"
                            [disabled]="element.approved_check"
                        />
                    </div>
                    <ng-template #ifNoValue>
                        <input
                            type="checkbox"
                            [checked]="element.is_nd"
                            (change)="getEntryData(element, 'is_nd')"
                            [disabled]="'true'"
                        />
                    </ng-template>
                </div>
            </td>
            </ng-container>

        <ng-container matColumnDef="Update">
            <th mat-header-cell *matHeaderCellDef>Update</th>
            <td mat-cell *matCellDef="let element">
                <!-- Hide the icons if the entry is approved (if approved_by has a value) -->
                <mat-icon 
                    class="cursor-pointer" 
                    (click)="timesheetEntryHoursUpdate(element.id)" 
                    *ngIf="!element.approved_by && !textField || element.id !== idData && !element.is_ot && !element.is_nd "
                >
                    edit
                </mat-icon>
                
                <mat-icon 
                    class="cursor-pointer text-green-600" 
                    *ngIf="textField && !element.approved_by && element.id === idData" 
                    (click)="saveEntry(element.id)"
                >
                    check
                </mat-icon>
                
                <mat-icon 
                    class="cursor-pointer text-red-600" 
                    *ngIf="textField && !element.approved_by && element.id === idData" 
                    (click)="timesheetEntryHoursUpdate(element.id)"
                >
                    close
                </mat-icon>
            </td>
        </ng-container>

        <!-- <form [formGroup]="form"> -->
            <ng-container matColumnDef="project_name">
                <th mat-header-cell *matHeaderCellDef>PROJECT NAME</th>
                <td mat-cell *matCellDef="let element">{{ element.project.project_name }}</td>
            </ng-container>
            <ng-container matColumnDef="date_created">
                <th mat-header-cell *matHeaderCellDef>DATE</th>
                <td mat-cell *matCellDef="let element">{{ element.date | date: "EEE, MMM d" }}</td>
            </ng-container>

            <ng-container matColumnDef="working_location">
                <th mat-header-cell *matHeaderCellDef>LOCATION</th>
                <td mat-cell *matCellDef="let element">

                  <span *ngIf="!textField || element.id !== idData">{{ element.working_location }}</span>
              
                    <mat-form-field *ngIf="textField && element.id === idData" class="w-32 mt-5">
                    <mat-label>Location</mat-label>
                        <mat-select [(value)]="workingLocationData" >
                            <mat-option [value]="'OFC-DW'">OFC-DW</mat-option>
                            <mat-option [value]="'OFC-ND'">OFC-ND</mat-option>
                            <mat-option [value]="'WFH'">WFH</mat-option>
                            <mat-option [value]="'FLD'">FLD</mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>
            </ng-container>
              
              
            <ng-container matColumnDef="working_type">
                <th mat-header-cell *matHeaderCellDef>TYPE</th>
                <td mat-cell *matCellDef="let element" >
                    <span *ngIf="!textField || element.id !== idData">{{ element.working_type  }}</span>

                    <mat-form-field *ngIf="textField && element.id === idData" class="w-32 mt-5">
                        <mat-label>Type</mat-label>
                            <mat-select [(value)]="typeData">
                                <mat-option [value]="'RG'">RG</mat-option>
                                <mat-option [value]="'ND'">ND</mat-option>
                                <mat-option [value]="'LVE'">LVE</mat-option>
                                <mat-option [value]="'OT'">OT</mat-option>
                                <mat-option [value]="'RD'" [disabled]="true">RD</mat-option>
                                <mat-option [value]="'SH'" [disabled]="true">SH</mat-option>
                                <mat-option [value]="'RH'" [disabled]="true">RH</mat-option>
                                <mat-option [value]="'RHRD'" [disabled]="true">RHRD</mat-option>
                                <mat-option [value]="'SHRD'" [disabled]="true">SHRD</mat-option>
                        </mat-select>
                    </mat-form-field>
            
                </td>
            </ng-container>

            <ng-container matColumnDef="actual_hours">
                <th mat-header-cell *matHeaderCellDef>DURATION</th>
                <td mat-cell *matCellDef="let element">
                    
                    <span *ngIf="!textField || element.id !== idData">{{ element.actual_hours }}h</span>

                    <mat-form-field *ngIf="textField && element.id === idData" class="w-32 mt-5">
                        <mat-label>Duration</mat-label>
                        <input [(ngModel)]="actualHoursData" matInput>
                    </mat-form-field>
                    
                </td>
            </ng-container>

            <ng-container matColumnDef="ot_number">
                <th mat-header-cell *matHeaderCellDef>OVERTIME</th>
                <td mat-cell *matCellDef="let element">
                    
                    <span *ngIf="!textField || element.id !== idData">{{ element.ot_number }}h</span>

                    <mat-form-field *ngIf="textField && element.id === idData" class="w-32 mt-5">
                        <mat-label>Overtime</mat-label>
                        <input [(ngModel)]="overtimeData" matInput>
                    </mat-form-field>

                </td>
            </ng-container>
            <ng-container matColumnDef="nd_number">
                <th mat-header-cell *matHeaderCellDef>Night Diff</th>
                <td mat-cell *matCellDef="let element">

                    <span *ngIf="!textField || element.id !== idData">{{ element.nd_number}}h</span>
                
                    <mat-form-field *ngIf="textField && element.id === idData" class="w-32 mt-5">
                        <mat-label>Night Diff.</mat-label>
                        <input [(ngModel)]="nightdiffData" matInput>
                    </mat-form-field>
                </td>
            </ng-container>
            <ng-container matColumnDef="description">
                <th mat-header-cell *matHeaderCellDef>TASK</th>
                <td mat-cell *matCellDef="let element">{{ element.description }}</td>
            </ng-container>
        <!-- </form> -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
    </div>
</mat-dialog-content>

<mat-paginator
    class="overflow-hidden whitespace-nowrap"
    [pageSizeOptions]="[4, 5, 6]"
    showFirstLastButtons
    aria-label="Select page of periodic elements"
>
</mat-paginator>
